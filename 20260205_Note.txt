2026/02/05
OCR Model é¸æ“‡
Google Vision OCR
    ä¸­è‹±æ··å­—ç©©å®š
    æ•¸å­—æº–
    ç¼ºé»ï¼šéŒ¢
PaddleOCR
    å¯é›¢ç·š
    ä¸­æ–‡æ¯” Tesseract å¥½
    å¯ fine-tune
Tesseractï¼ˆèª¿æ•™å¾Œï¼‰
    ä¸€å®šè¦ï¼š
    chi_tra + eng
    ä¸èª¿æ•™ = ä¸æº–

ç›®å‰ Django + ç™¼ç¥¨å°ˆæ¡ˆ
1ï¸âƒ£ OCR ä¸€å¾‹èµ°ï¼š
    Grayscale â†’ Adaptive Threshold
2ï¸âƒ£ OCR è·‘å…©æ¬¡ï¼š
    - chi_tra+eng
    - eng+digits
3ï¸âƒ£ Parser å±¤åšèªæ„ä¿®æ­£ï¼ˆä¸æ˜¯é  OCRï¼‰
4ï¸âƒ£ æœªä¾†å†å‡ç´š ML / LLM è£œåˆ¤æ–·

å°ç£ç™¼ç¥¨ OCR Pipelineï¼ˆæ–‡å­—åœ–ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“· Camera / Upload          â”‚
â”‚  - æ‰‹æ©Ÿç›¸æ©Ÿ / ä¸Šå‚³åœ–ç‰‡        â”‚
â”‚  - å³æ™‚æ¸…æ™°åº¦ / äº®åº¦æª¢æŸ¥      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ§ª Stream Pre-Filter         â”‚
â”‚  - æ˜¯å¦æ¨¡ç³Šï¼Ÿ                 â”‚
â”‚  - æ˜¯å¦éæš— / éæ›ï¼Ÿ           â”‚
â”‚  - æ˜¯å¦å¯ OCRï¼Ÿ               â”‚
â”‚  âŒ ä¸åˆæ ¼ â†’ æç¤ºé‡æ‹         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ› OCR-friendly Preprocess   â”‚
â”‚  1. Grayscale                â”‚
â”‚  2. Adaptive Threshold       â”‚
â”‚  3. è¼•åº¦å»å™ª                 â”‚
â”‚  4. Deskewï¼ˆå¯é¸ï¼‰           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” QR Code Detection         â”‚
â”‚  - æ˜¯å¦æœ‰ QR Codeï¼Ÿ          â”‚
â”‚  - å˜—è©¦ decode               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚
        â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… QR æˆåŠŸ       â”‚   â”‚ âŒ QR å¤±æ•— / ç„¡ QR     â”‚
â”‚                  â”‚   â”‚                        â”‚
â”‚ - ç™¼ç¥¨è™Ÿç¢¼        â”‚   â”‚ â†’ é€²å…¥ OCR æµç¨‹        â”‚
â”‚ - æ—¥æœŸ            â”‚   â”‚                        â”‚
â”‚ - é‡‘é¡            â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ - è³£æ–¹ç·¨è™Ÿ        â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â–¼
          â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚           â”‚ ğŸ§  Dual OCR Strategy   â”‚
          â”‚           â”‚                        â”‚
          â”‚           â”‚ OCR-A: chi_tra + eng   â”‚
          â”‚           â”‚  - åº—å / å“é …          â”‚
          â”‚           â”‚                        â”‚
          â”‚           â”‚ OCR-B: eng + digits    â”‚
          â”‚           â”‚  - é‡‘é¡ / æ—¥æœŸ / ç·¨è™Ÿ   â”‚
          â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                         â”‚
          â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ§© OCR Result Merge                          â”‚
â”‚  - åˆä½µ A / B çµæœ                            â”‚
â”‚  - å»é™¤é‡è¤‡æ–‡å­—                               â”‚
â”‚  - å€åŸŸå„ªå…ˆï¼ˆTOTAL / æ—¥æœŸ / å“é …ï¼‰             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ Parser / Rule Engine                      â”‚
â”‚  - ç™¼ç¥¨è™Ÿç¢¼æ ¼å¼é©—è­‰ (AA-12345678)              â”‚
â”‚  - æ—¥æœŸåˆæ³•æ€§ (æ°‘åœ‹ / è¥¿å…ƒè½‰æ›)                â”‚
â”‚  - é‡‘é¡åªå…è¨±æ•¸å­—                              â”‚
â”‚  - Oâ†’0 / Iâ†’1 / Sâ†’5 ä¿®æ­£                       â”‚
â”‚  - å“é …æ–‡å­—å®¹éŒ¯                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ§  Category / Subcategory Decision          â”‚
â”‚  - å“é …é—œéµå­—                                â”‚
â”‚  - OCR + è¦å‰‡                                â”‚
â”‚  - AI / MLï¼ˆæœªä¾†å¯æ’ï¼‰                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ§¾ Invoice Data Object                      â”‚
â”‚  - number                                   â”‚
â”‚  - date                                     â”‚
â”‚  - total                                    â”‚
â”‚  - items[]                                  â”‚
â”‚  - category / subcategory                   â”‚
â”‚  - raw_qr_data / raw_ocr_data               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¤ Confirm UI (äººé¡æœ€å¾Œä¸€é—œ)                  â”‚
â”‚  - ä½¿ç”¨è€…ç¢ºèª / ä¿®æ­£                          â”‚
â”‚  - ä¸ä¿¡ OCRï¼Œä¿¡äºº                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ—„ Django DB (Single Source of Truth)        â”‚
â”‚  - Invoice                                  â”‚
â”‚  - Item                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š Google Sheets (åŒæ­¥ / å ±è¡¨ / äººçœ‹)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ æ¨¡çµ„è²¬ä»»åŠƒåˆ†
services/
 â”œâ”€ ocr/
 â”‚   â”œâ”€ base.py            # OCR æŠ½è±¡å±¤
 â”‚   â”œâ”€ ocr_chi_eng.py     # OCR-A
 â”‚   â”œâ”€ ocr_eng_digits.py  # OCR-B
 â”‚   â””â”€ dual_ocr.py        # â­ Dual OCR Strategy
 â”‚
 â”œâ”€ preprocess/
 â”‚   â””â”€ ocr_friendly.py
 â”‚
 â””â”€ invoice_parser.py
Dual OCR åªè² è²¬ã€Œå–å¾—ç©©å®šæ–‡å­—è¼¸å…¥ã€
ä¸åšè§£æã€ä¸åšåˆ†é¡ã€ä¸åšå­¸ç¿’

2ï¸âƒ£ Dual OCR Strategy æµç¨‹
image
 â†“
Preprocess (grayscale / threshold)
 â†“
OCR-A (chi_tra + eng)      â†’ åº—å / å“é …
OCR-B (eng + digits)       â†’ é‡‘é¡ / æ—¥æœŸ / ç™¼ç¥¨è™Ÿç¢¼
 â†“
Result Mergeï¼ˆä¿ç•™ä¾†æºï¼‰
 â†“
äº¤çµ¦ Parser

pytesseract
ç¹é«”ä¸­æ–‡å’Œè¾¨è­˜è‹±æ–‡ä¸€æ¨£ï¼Œä½†æ˜¯è¦ä¸‹è¼‰ç¹é«”ä¸­æ–‡çš„è¨“ç·´è³‡æ–™
åˆ° https://github.com/tesseract-ocr/tessdata_best/blob/master/chi_tra.traineddata ä¸‹è¼‰
ä¸¦å°‡æª”æ¡ˆæ”¾åˆ° C:\Program Files\Tesseract-OCR\tessdata ä¸­ï¼Œ
ä¿®æ”¹ lang åƒæ•¸è®Šæˆ chi_tra å°±å¯ä»¥
==========
import pytesseract
from PIL import Image

def main():
    pytesseract.pytesseract.tesseract_cmd = r"C:\Program Files\Tesseract-OCR\tesseract.exe"
    img = Image.open(r"image\2.JPG")
    #img.show()
    print(pytesseract.image_to_string(img, lang="chi_tra"))

if __name__ == "__main__":
    main()
==========
Tesseract PSM æ¨¡å¼å°ç…§è¡¨
PSM ç·¨è™Ÿ	èªªæ˜	é©åˆç”¨é€”
0	Orientation and script detection (OSD) only
    åªæª¢æ¸¬æ–‡å­—æ–¹å‘èˆ‡èªç³»ï¼Œä¸åšæ–‡å­—è¾¨è­˜ã€‚ç”¨ä¾†ç¢ºèªæ—‹è½‰æˆ–æ–‡å­—èªè¨€ã€‚
1	Automatic page segmentation with OSD
    è‡ªå‹•åˆ‡ç‰ˆ + æ–¹å‘/èªç³»æª¢æ¸¬ã€‚å®Œæ•´é é¢ OCR å‰å¯å…ˆç”¨ä¾†æª¢æ¸¬æ–¹å‘ã€‚
2	Automatic page segmentation, but no OSD, or OCR
    è‡ªå‹•åˆ‡ç‰ˆï¼Œä½†ä¸æª¢æ¸¬æ–¹å‘ï¼Œä¹Ÿä¸åŸ·è¡Œ OCRã€‚ä¸»è¦ç”¨ä½œæ¸¬è©¦ç‰ˆé¢åˆ†å‰²ã€‚
3	Fully automatic page segmentation, but no OSD (Default)
    å®Œå…¨è‡ªå‹•åˆ‡ç‰ˆï¼Œä¸æª¢æ¸¬æ–¹å‘ã€‚Tesseract é è¨­æ¨¡å¼ï¼Œé©åˆä¸€èˆ¬æ–‡ä»¶æˆ–å¤šæ¬„é é¢ã€‚
4	Assume a single column of text of variable sizes
    å‡è¨­æ•´é æ˜¯å–®æ¬„æ–‡å­—ï¼Œä½†å­—å‹å¤§å°å¯èƒ½ä¸ä¸€ã€‚é©åˆå ±è¡¨æˆ–ä¿¡ä»¶ã€‚
5	Assume a single uniform block of vertically aligned text
    å‡è¨­æ•´é æ–‡å­—æ˜¯å‚ç›´æ’åˆ—ä¸”å¤§å°ä¸€è‡´ã€‚å°‘ç”¨ï¼Œä¸€èˆ¬ä¸­æ–‡å¤ç±æˆ–æ—¥æ–‡è±æ’æ‰ç”¨ã€‚
6	Assume a single uniform block of text
    å‡è¨­æ•´é æ˜¯ä¸€å€‹å–®ä¸€æ–‡å­—å€å¡Šã€‚ç™¼ç¥¨ã€å–®å¼µè¡¨æ ¼ã€æ”¶æ“šå¸¸ç”¨ã€‚
7	Treat the image as a single text line
    å‡è¨­æ•´å¼µåœ–åªæ˜¯ä¸€è¡Œæ–‡å­—ã€‚é©åˆé‡‘é¡ã€æ—¥æœŸã€å–®è¡Œæ¨™é¡Œã€‚
8	Treat the image as a single word
    å‡è¨­æ•´å¼µåœ–åªæœ‰ä¸€å€‹å–®è©ã€‚é©åˆç™¼ç¥¨è™Ÿç¢¼æˆ–æ¢ç¢¼ OCRã€‚
9	Treat the image as a single word in a circle
    å‡è¨­åœ–ç‰‡ä¸­åªæœ‰ä¸€å€‹åœ“å½¢å…§çš„å–®è©ã€‚å¾ˆå°‘ç”¨ï¼Œä¸»è¦æ˜¯ logo æˆ–ç‰¹æ®Šåœ–å½¢æ–‡å­—ã€‚
10	Treat the image as a single character
    å‡è¨­åœ–ç‰‡åªæ˜¯ä¸€å€‹å­—å…ƒã€‚é©åˆå–®å€‹å­—æˆ–ç¬¦è™Ÿçš„è¾¨è­˜ã€‚
11	Sparse text. Find as much text as possible in no particular order
    å‡è¨­æ–‡å­—åˆ†æ•£ä¸”ç„¡å›ºå®šé †åºã€‚é©åˆæ‰‹å¯«ã€æ•£è½çš„ç¥¨æ“šæˆ–æ¨™ç±¤ã€‚
12	Sparse text with OSD
    å’Œ 11 é¡ä¼¼ï¼Œä½†åŒæ™‚æª¢æ¸¬æ–¹å‘/èªç³»ã€‚
13	Raw line. Treat the image as a single text line, bypassing Tesseract-specific hacks
    ç•¶ä½œå–®è¡Œæ–‡å­—ï¼Œä½†ä¸ä½¿ç”¨ Tesseract çš„å…§éƒ¨å„ªåŒ–ã€‚å¤šç”¨æ–¼ç¨‹å¼æ¸¬è©¦æˆ–ç‰¹æ®Šéœ€æ±‚ã€‚